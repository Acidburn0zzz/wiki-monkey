// Generated by CoffeeScript 1.10.0
module.exports.DeletePages = (function() {
  function DeletePages(WM) {
    this.WM = WM;
  }

  DeletePages.prototype.mainAuto = function(args, title, callBot, chainArgs) {
    var summary;
    summary = args;
    return this.WM.MW.callQuery({
      prop: 'info',
      intoken: 'delete',
      titles: title
    }, this.WM.Plugins.DeletePages.mainAutoWrite, [title, summary, callBot], null);
  };

  DeletePages.prototype.mainAutoWrite = function(page, args) {
    var callBot, deletetoken, summary, title;
    title = args[0];
    summary = args[1];
    callBot = args[2];
    deletetoken = page.deletetoken;
    return this.WM.MW.callAPIPost({
      action: 'delete',
      bot: '1',
      title: title,
      token: deletetoken,
      reason: summary
    }, null, this.WM.Plugins.DeletePages.mainAutoEnd, [title, callBot], null);
  };

  DeletePages.prototype.mainAutoEnd = function(res, args) {
    var callBot, title;
    title = args[0];
    callBot = args[1];
    if (!res["delete"]) {
      if (res.error) {
        this.WM.Log.logError((this.WM.Log.linkToWikiPage(title, title)) + " has not been deleted!\n" + res.error.info + " (" + res.error.code + ")");
        return callBot(res.error.code, null);
      } else {
        return callBot(false, null);
      }
    } else {
      return callBot(1, null);
    }
  };

  return DeletePages;

})();
