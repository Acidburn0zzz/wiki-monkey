// Generated by CoffeeScript 1.12.7
module.exports.ExpandContractions = (function() {
  ExpandContractions.REQUIRES_GM = false;

  function ExpandContractions(WM) {
    this.WM = WM;
  }

  ExpandContractions.prototype.replace = function(source, regExp, newString, checkString, checkStrings) {
    var newtext;
    newtext = source.replace(regExp, newString);
    if (checkStrings.length > 1 && newtext !== source) {
      this.WM.Log.logWarning("Replaced some \"" + checkString + "\" with \"" + checkStrings[0] + "\": check that it didn't mean \"" + (checkStrings.slice(1).join('\" or \"')) + "\" instead");
    }
    return newtext;
  };

  ExpandContractions.prototype.main = function(args, callNext) {
    var newtext, source, ss;
    source = this.WM.Editor.readSource();
    newtext = source;
    newtext = this.replace(newtext, /([a-z])'re/ig, '$1 are', "'re", ["are"]);
    newtext = this.replace(newtext, /([a-z])'ve/ig, '$1 have', "'ve", ["have"]);
    newtext = this.replace(newtext, /([a-z])'ll/ig, '$1 will', "'ll", ["will", "shall"]);
    newtext = this.replace(newtext, /([a-z])'d/ig, '$1 would', "'d", ["would", "had"]);
    newtext = this.replace(newtext, /(c)an't/ig, '$1annot', "can't", ["cannot"]);
    newtext = this.replace(newtext, /(w)on't/ig, '$1ill not', "won't", ["will not"]);
    newtext = this.replace(newtext, /([a-z])n't/ig, '$1 not', "n't", ["not"]);
    newtext = this.replace(newtext, /(here|there)'s/ig, '$1 is', "here/there's", ["here/there is", "here/there has"]);
    newtext = this.replace(newtext, /(g)onna/ig, '$1oing to', "gonna", ["going to"]);
    newtext = this.replace(newtext, /([a-z])'s (been)/ig, '$1 has $2', "'s been", ["has been"]);
    newtext = this.replace(newtext, /(let)'s/ig, '$1 us', "let's", ["let us"]);
    newtext = this.replace(newtext, /(it)'(s own)/ig, '$1$2', "it's own", ["its own"]);
    ss = newtext.match(/[a-z]'s/gi);
    if (ss) {
      this.WM.Log.logWarning("Found " + ss.length + " instances of \"'s\": " + "check if they can be replaced with \"is\", \"has\", ...");
    }
    if (newtext !== source) {
      this.WM.Editor.writeSource(newtext);
      this.WM.Log.logInfo("Expanded contractions");
    }
    if (callNext) {
      return callNext();
    }
  };

  return ExpandContractions;

})();
